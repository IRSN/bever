<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Create an object representing a &quot;Poor Man's&quot; Posterior for a
Poisson-GP model, mainly using MCMC iterates."><title>Create a Posterior for a Poisson-GP Model — poisGPBayes0 • bever</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a Posterior for a Poisson-GP Model — poisGPBayes0"><meta property="og:description" content="Create an object representing a &quot;Poor Man's&quot; Posterior for a
Poisson-GP model, mainly using MCMC iterates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bever</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/User.html">The bever Package User Guide</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create a Posterior for a Poisson-GP Model</h1>
      
      <div class="d-none name"><code>poisGPBayes0.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create an object representing a "Poor Man's" Posterior for a
Poisson-GP model, mainly using MCMC iterates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">poisGPBayes0</span><span class="op">(</span><span class="va">MCMC</span>, <span class="va">threshold</span>,</span>
<span>             data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">effDuration</span>,</span>
<span>             MAX.data <span class="op">=</span> <span class="cn">NULL</span>, MAX.effDuration <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             OTS.data <span class="op">=</span> <span class="cn">NULL</span>, OTS.threshold <span class="op">=</span> <span class="cn">NULL</span>, OTS.effDuration <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             MAP <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             nOT <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>             a0 <span class="op">=</span> <span class="fl">1.0</span>, b0 <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>MCMC</dt>
<dd><p>An object that can be coerced into a matrix containing
the MCMC iterates. It should have the burnin period removed and be
thinned if necessary.</p></dd>


<dt>threshold</dt>
<dd><p>the POT threshold.</p></dd>


<dt>data</dt>
<dd><p>An optional structure containing the observations Over
the Threshold. The user should make sure that these data are
identical to those used to obtain <code>MCMC</code>. It can be a numeric
vector or an object inheriting from one of the two classes
<code>"Rendata"</code> (from <strong>Renext</strong>) and <code>"potData"</code> (from
<strong>potomax</strong>) in which case it will be coerced into the class
<code>"potData"</code>.</p></dd>


<dt>effDuration</dt>
<dd><p>The observation effective duration. When
<code>data</code> can be coerced into <code>potData</code>, the provided
value for <code>effDuration</code> will be ignored and the value
of <code>object$OT$effDuration</code> will be used instead.</p></dd>


<dt>MAX.data, MAX.effDuration</dt>
<dd><p>Optional censored data (type block
maxima or \(r\)-largest) as used in
<code><a href="https://irsn.github.io/potomax/reference/poisGP.html" class="external-link">poisGP</a></code>. Ignored if <code>data</code> inherits
from one of the two classes <code>"Rendata"</code> and <code>"potData"</code></p></dd>


<dt>OTS.data, OTS.threshold, OTS.effDuration</dt>
<dd><p>Optional censored
data as used in <code><a href="https://irsn.github.io/potomax/reference/poisGP.html" class="external-link">poisGP</a></code>. Ignored if
<code>data</code> inherits from one of the two classes <code>"Rendata"</code>
and <code>"potData"</code></p></dd>


<dt>MAP</dt>
<dd><p>An optional vector of Maximum A Posteriori for the
parameter vector. Should be named with names matching the
colnames of <code>MCMC</code>.</p></dd>


<dt>nOT</dt>
<dd><p>An optional integer giving the number of exceedances
during the observation period. This number is needed when
<code>MCMC</code> does not have a column for the rate of the Poisson
process. It should be consistent with <code>MCMC</code>.</p></dd>


<dt>a0, b0</dt>
<dd><p>The shape and the rate of the prior for <code>lambda</code>
(used only when <code>MCMC</code> has two columns).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object with class <code>"GEVBayes0"</code> inheriting from
<code>"Bayes0"</code>. This object can be used to produce RL plots.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Poisson-GP model involves three parameters: one is
the rate <code>lambda</code> of the Poisson process describing the
exceedances over the threshold. The two other parameters are the
scale and the shape of the GP Distribution used for the excesses
over the threshold. The object MCMC can have either three columns
or two columns only. In the second case, the column corresponding
to the rate <code>lambda</code> is omitted; it is then assumed that
<code>lambda</code> is a posteriori independent of the GP parameters and
that it has a gamma posterior margin. The shape of the posterior
distribution is \(a_n := a_0 + n_{\textrm{OT}}\)
and the rate is \(b_n := b_0 + w_{\textrm{OT}}\),
where \(w_{\textrm{OT}}\) and \(w_{\textrm{OT}}\)
are the number of exceedances and the duration of the observation
period.</p>
    </div>
    <div class="section level2">
    <h2 id="caution">Caution<a class="anchor" aria-label="anchor" href="#caution"></a></h2>
    <p>The user must be sure that the data provided by
using the dedicated arguments are consistent with the MCMC
iterates provided in <code>MCMC</code>. The 'data' dedicated arguments
are: <code>data</code>, <code>effDuration</code> or/and <code>MAX.data</code>,
<code>MAX.effDuration</code> <code>OTS.data</code>, <code>OTS.threshold</code>,
<code>OTS.effDuration</code>. Since attaching data to the object is
essentially for graphical purpose, it can be simpler not to attach
the data and to create a separated object with class
<code>"potData"</code>. This object can be used with its
<code>autolayer</code> method.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code>RL</code> method to generate a data frame of
"classical" return levels (as shown on a classical RL plot),
<code><a href="predict.poisGPBayes0.html">predict.poisGPBayes0</a></code> to generate a data frame of
predictive return levels (as shown on a predictive RL plot).</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://paulnorthrop.github.io/revdbayes/" class="external-link">revdbayes</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## use the 'rainfall data': daily rainfalls over 57 years</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">rainfall</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rainfall2</span> <span class="op">&lt;-</span> <span class="va">rainfall</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rainfall</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fl">40</span>  <span class="co">## threshold (mm)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fl">57</span>  <span class="co">## obs duration (year)</span></span></span>
<span class="r-in"><span><span class="va">nOT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rainfall2</span> <span class="op">&gt;</span> <span class="va">u</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulnorthrop.github.io/revdbayes/reference/set_prior.html" class="external-link">set_prior</a></span><span class="op">(</span>prior <span class="op">=</span> <span class="st">"flatflat"</span>, model <span class="op">=</span> <span class="st">"gp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nSim</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## get a posterior for the "excess part" of the model</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="va">postGP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulnorthrop.github.io/revdbayes/reference/rpost.html" class="external-link">rpost</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, model <span class="op">=</span> <span class="st">"gp"</span>, prior <span class="op">=</span> <span class="va">prior</span>,</span></span>
<span class="r-in"><span>                data <span class="op">=</span> <span class="va">rainfall2</span>, thresh <span class="op">=</span> <span class="va">u</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MCMCGP</span> <span class="op">&lt;-</span> <span class="va">postGP</span><span class="op">$</span><span class="va">sim_vals</span></span></span>
<span class="r-in"><span><span class="va">MAP</span> <span class="op">&lt;-</span> <span class="va">postGP</span><span class="op">$</span><span class="va">f_mode</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">MAP</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scale"</span>, <span class="st">"shape"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## assuming a "flat gamma prior" for 'lambda', add MCMC iterates</span></span></span>
<span class="r-in"><span><span class="co">## for 'lambda' to those existing for GP (new matrix column)</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="va">MCMCpoisGP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">nSim</span>, shape <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">nOT</span>, rate <span class="op">=</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">w</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    <span class="va">MCMCGP</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## create the object</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="va">post0</span> <span class="op">&lt;-</span> <span class="fu">poisGPBayes0</span><span class="op">(</span>MCMC <span class="op">=</span> <span class="va">MCMCpoisGP</span>, threshold <span class="op">=</span> <span class="va">u</span>, effDuration <span class="op">=</span> <span class="va">w</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">post0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> poisGP Model Bayesian Inference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Number of OT observations: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Number of MCMC iterates: 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Posterior mean [sd]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      lambda       scale       shape </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.53 [0.16] 7.99 [1.27] 0.19 [0.13] </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">post0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          lambda    scale     shape</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mean   1.526300 7.987665 0.1947722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> median 1.522316 7.907451 0.1802754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mode         NA       NA        NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## 'lambda' and the GP parameters are a posteriori independent</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov2cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">post0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              lambda        scale        shape</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda  1.000000000 -0.003300372  0.003631015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  -0.003300372  1.000000000 -0.593252985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape   0.003631015 -0.593252985  1.000000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## create an object assuming 'lambda' independent of the GP param</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="va">post1</span> <span class="op">&lt;-</span> <span class="fu">poisGPBayes0</span><span class="op">(</span>MCMC <span class="op">=</span> <span class="va">MCMCGP</span>, threshold <span class="op">=</span> <span class="va">u</span>,</span></span>
<span class="r-in"><span>                      effDuration <span class="op">=</span> <span class="va">w</span>, nOT <span class="op">=</span> <span class="va">nOT</span>, MAP <span class="op">=</span> <span class="va">MAP</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

